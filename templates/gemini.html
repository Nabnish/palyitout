<body>
  <div class="container">
    <div class="chat-container">
      <!-- Playlist column -->
      <div class="playlist-column">
        {% if songs %}
          <h3>Your Playlist:</h3>
          {% for song in songs %}
            <div class="song">
              <img src="{{ song.album_art }}" width="60" height="60">
              <div style="flex:1;">
                <strong>{{ song.title }}</strong> - {{ song.artist }}<br>
                {% if song.uri %}
                  <audio controls style="width: 100%;">
                    <source src="{{ song.uri }}" type="audio/mpeg">
                  </audio>
                {% endif %}
                {% if spotify_connected %}
                  <a href="{{ song.spotify_url }}" target="_blank" style="color:#ff004c;">Open in Spotify</a>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        {% endif %}
      </div>

      <!-- Chat + info column -->
      <div class="chat-column">
        <div class="chat-box">
          {% if response %}
            <div class="message user">{{ request.form.get('message') }}</div>
            <div class="message ai">{{ response }}</div>
          {% else %}
            <div class="message ai">Hello! I'm Gemini AI. Ask me for a playlist!</div>
          {% endif %}
        </div>

        <!-- Keyboard + Spotify buttons -->
        <div class="chat-footer">
          <form method="POST" class="chat-input">
            <input type="text" name="message" placeholder="Type a message..." required>
            <button type="submit">Send</button>
          </form>

          {% if spotify_connected %}
            <form method="POST" action="{{ url_for('create_spotify_playlist') }}">
              <input type="hidden" name="songs" value="{{ song_str }}">
              <button type="submit" class="playlist-button">Create Spotify Playlist</button>
            </form>
          {% else %}
            <a href="{{ url_for('spotify_login') }}" class="playlist-button">Connect Spotify</a>
          {% endif %}
        </div>
      </div>

      <!-- Right info panel -->
      <div class="info-column">
        <h3>Info Panel</h3>
        <p>Some info or stats about your playlist or AI suggestions can go here.</p>
      </div>
    </div>
  </div>

  <style>
    body { margin:0; font-family: Arial,sans-serif; background:#000; color:white; }
    .container { display:flex; height:100vh; width:100%; padding:0; }
    .chat-container { display:flex; flex:1; height:100%; }
    .playlist-column { width:300px; padding:20px; background:rgba(0,0,0,0.7); overflow-y:auto; }
    .chat-column { flex:1; display:flex; flex-direction:column; justify-content:flex-end; padding:20px; }
    .chat-box { flex:1; overflow-y:auto; background:rgba(0,0,0,0.5); padding:20px; border-radius:15px; margin-bottom:10px; }
    .chat-footer { display:flex; flex-direction:column; gap:10px; }
    .chat-input { display:flex; gap:10px; }
    .chat-input input { flex:1; padding:12px; border-radius:25px; border:none; background:rgba(255,255,255,0.1); color:white; }
    .chat-input button, .playlist-button { padding:12px 20px; border-radius:25px; border:none; background:#ff004c; color:white; cursor:pointer; }
    .chat-input button:hover, .playlist-button:hover { background:#e60042; }
    .info-column { width:200px; padding:20px; background:rgba(0,0,0,0.6); }
    .song { display:flex; align-items:center; gap:10px; margin-bottom:10px; }
    .song img { border-radius:8px; }
  </style>
</body>
